# PostHog Go å‹åŠ›æµ‹è¯•å·¥å…·

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨PostHog Go SDKçš„å‹åŠ›æµ‹è¯•å·¥å…·ï¼Œç”¨äºå¯¹PostHogåˆ†æå¹³å°è¿›è¡Œæ€§èƒ½æµ‹è¯•å’Œå‹åŠ›æµ‹è¯•ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸš€ **é«˜æ€§èƒ½å‹åŠ›æµ‹è¯•**: æ”¯æŒå¤šå¹¶å‘è¯·æ±‚ï¼Œæµ‹è¯•PostHog APIæ€§èƒ½
- ğŸ“Š **è¯¦ç»†ç»Ÿè®¡æŠ¥å‘Š**: æä¾›æˆåŠŸç‡ã€RPSã€è€—æ—¶ç­‰è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯
- ğŸ”§ **çµæ´»é…ç½®**: æ”¯æŒè‡ªå®šä¹‰å¹¶å‘æ•°ã€è¯·æ±‚æ•°ã€äº‹ä»¶åç§°ç­‰å‚æ•°
- ğŸŒ **å¤šç«¯ç‚¹æ”¯æŒ**: æ”¯æŒç¾å›½ã€æ¬§ç›Ÿç­‰ä¸åŒPostHogç«¯ç‚¹
- ğŸ’» **å‘½ä»¤è¡Œç•Œé¢**: ç®€å•æ˜“ç”¨çš„å‘½ä»¤è¡Œå‚æ•°é…ç½®
- ğŸ“ˆ **å®æ—¶ç›‘æ§**: å®æ—¶æ˜¾ç¤ºæµ‹è¯•è¿›åº¦å’Œç»“æœ

## ç¯å¢ƒè¦æ±‚

- Go 1.19 æˆ–æ›´é«˜ç‰ˆæœ¬
- æœ‰æ•ˆçš„PostHogé¡¹ç›®APIå¯†é’¥

## å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd posthog-go-test
```

### 2. å®‰è£…ä¾èµ–

```bash
make deps
```

### 3. è·å–PostHog APIå¯†é’¥

1. ç™»å½•ä½ çš„PostHogè´¦æˆ·
2. è¿›å…¥é¡¹ç›®è®¾ç½®
3. å¤åˆ¶é¡¹ç›®APIå¯†é’¥ï¼ˆæ ¼å¼ç±»ä¼¼ï¼š`phc_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`ï¼‰

### 4. è¿è¡Œå‹åŠ›æµ‹è¯•

#### åŸºæœ¬ç”¨æ³•

```bash
# ä½¿ç”¨é»˜è®¤å‚æ•°è¿è¡Œå‹åŠ›æµ‹è¯•
go run main.go -key phc_your_api_key_here
```

#### ä½¿ç”¨Makefileï¼ˆæ¨èï¼‰

```bash
# åŸºæœ¬å‹åŠ›æµ‹è¯•
make stress-test API_KEY=phc_your_api_key_here

# è‡ªå®šä¹‰å‚æ•°å‹åŠ›æµ‹è¯•
make stress-test-custom API_KEY=phc_your_api_key_here CONCURRENT=20 REQUESTS=1000

# æ¬§ç›Ÿç«¯ç‚¹å‹åŠ›æµ‹è¯•
make stress-test-eu API_KEY=phc_your_api_key_here
```

## å‘½ä»¤è¡Œç”¨æ³•

### åŸºæœ¬è¯­æ³•

```bash
go run main.go -key <API_KEY> [é€‰é¡¹]
```

### å¿…éœ€å‚æ•°

- `-key string`: PostHog APIå¯†é’¥ï¼ˆå¿…éœ€ï¼‰

### å¯é€‰å‚æ•°

- `-endpoint string`: PostHogç«¯ç‚¹URLï¼ˆé»˜è®¤: `https://your-posthog-instance.com`ï¼‰
- `-concurrent int`: å¹¶å‘æ•°ï¼ˆé»˜è®¤: 10ï¼‰
- `-requests int`: æ€»è¯·æ±‚æ•°ï¼ˆé»˜è®¤: 100ï¼‰
- `-event string`: äº‹ä»¶åç§°ï¼ˆé»˜è®¤: `stress-test-event`ï¼‰
- `-user string`: ç”¨æˆ·IDï¼ˆé»˜è®¤: `stress-test-user`ï¼‰
- `-help, -h`: æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

### ä½¿ç”¨ç¤ºä¾‹

```bash
# åŸºæœ¬å‹åŠ›æµ‹è¯•
go run main.go -key phc_your_api_key_here

# é«˜å¹¶å‘å‹åŠ›æµ‹è¯•
go run main.go -key phc_your_api_key_here -concurrent 50 -requests 5000

# ä½¿ç”¨è‡ªå®šä¹‰ç«¯ç‚¹
go run main.go -key phc_your_api_key_here -endpoint https://your-custom-posthog.com

# è‡ªå®šä¹‰äº‹ä»¶å’Œç”¨æˆ·
go run main.go -key phc_your_api_key_here -event "custom-event" -user "test-user-123"

# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
go run main.go -help
```

### è¾“å‡ºç¤ºä¾‹

```
å¼€å§‹å‹åŠ›æµ‹è¯•...
APIå¯†é’¥: phc_***QYO
ç«¯ç‚¹: https://your-posthog-instance.com
å¹¶å‘æ•°: 10
æ€»è¯·æ±‚æ•°: 100
äº‹ä»¶åç§°: stress-test-event
ç”¨æˆ·ID: stress-test-user
----------------------------------------
----------------------------------------
å‹åŠ›æµ‹è¯•å®Œæˆ!
æ€»è¯·æ±‚æ•°: 100
æˆåŠŸè¯·æ±‚: 98
å¤±è´¥è¯·æ±‚: 2
æˆåŠŸç‡: 98.00%
æ€»è€—æ—¶: 2.345s
å¹³å‡RPS: 42.64
```

## å¯ç”¨å‘½ä»¤

ä½¿ç”¨ `make help` æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤ï¼š

```bash
make help
```

### å‹åŠ›æµ‹è¯•å‘½ä»¤

- `make stress-test API_KEY=your_key` - è¿è¡ŒåŸºæœ¬å‹åŠ›æµ‹è¯•ï¼ˆè‡ªæ‰˜ç®¡ç«¯ç‚¹ï¼‰
- `make stress-test-custom API_KEY=your_key CONCURRENT=20 REQUESTS=1000` - è¿è¡Œè‡ªå®šä¹‰å‹åŠ›æµ‹è¯•
- `make stress-test-help` - æ˜¾ç¤ºå‹åŠ›æµ‹è¯•å¸®åŠ©ä¿¡æ¯

### å¼€å‘å‘½ä»¤

- `make build` - æ„å»ºé¡¹ç›®
- `make run` - è¿è¡Œé¡¹ç›®
- `make test` - è¿è¡Œæµ‹è¯•
- `make clean` - æ¸…ç†æ„å»ºæ–‡ä»¶
- `make fmt` - æ ¼å¼åŒ–ä»£ç 
- `make vet` - ä»£ç æ£€æŸ¥

### å¼€å‘å·¥å…·

- `make install-tools` - å®‰è£…å¼€å‘å·¥å…·ï¼ˆgolangci-lintç­‰ï¼‰
- `make install-air` - å®‰è£…çƒ­é‡è½½å·¥å…·
- `make dev` - å¼€å‘æ¨¡å¼ï¼ˆæ”¯æŒçƒ­é‡è½½ï¼‰

## é¡¹ç›®ç»“æ„

```
posthog-go-test/
â”œâ”€â”€ main.go          # ä¸»ç¨‹åºæ–‡ä»¶
â”œâ”€â”€ go.mod           # Goæ¨¡å—æ–‡ä»¶
â”œâ”€â”€ go.sum           # ä¾èµ–æ ¡éªŒæ–‡ä»¶
â”œâ”€â”€ Makefile         # æ„å»ºè„šæœ¬
â”œâ”€â”€ .gitignore       # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md        # é¡¹ç›®è¯´æ˜
```

## é…ç½®è¯´æ˜

### PostHogé…ç½®

é¡¹ç›®ä½¿ç”¨PostHog Go SDKï¼Œé»˜è®¤ä½¿ç”¨è‡ªæ‰˜ç®¡ç«¯ç‚¹ï¼š

- **é»˜è®¤ç«¯ç‚¹**: `https://your-posthog-instance.com`
- **è‡ªå®šä¹‰ç«¯ç‚¹**: å¯é€šè¿‡ `-endpoint` å‚æ•°æŒ‡å®šä»»æ„PostHogå®ä¾‹åœ°å€

### å‹åŠ›æµ‹è¯•å‚æ•°

- **å¹¶å‘æ•°**: æ§åˆ¶åŒæ—¶å‘é€è¯·æ±‚çš„åç¨‹æ•°é‡ï¼Œå½±å“æµ‹è¯•å¼ºåº¦
- **è¯·æ±‚æ•°**: æ€»å…±å‘é€çš„äº‹ä»¶æ•°é‡
- **äº‹ä»¶åç§°**: å‘é€çš„äº‹ä»¶ç±»å‹ï¼Œä¾¿äºåœ¨PostHogä¸­è¯†åˆ«
- **ç”¨æˆ·ID**: äº‹ä»¶å…³è”çš„ç”¨æˆ·æ ‡è¯†ç¬¦

### æ€§èƒ½è°ƒä¼˜å»ºè®®

1. **å¹¶å‘æ•°è®¾ç½®**:
   - å°è§„æ¨¡æµ‹è¯•: 10-50
   - ä¸­ç­‰è§„æ¨¡æµ‹è¯•: 50-200
   - å¤§è§„æ¨¡æµ‹è¯•: 200-1000

2. **è¯·æ±‚æ•°è®¾ç½®**:
   - å¿«é€ŸéªŒè¯: 100-1000
   - æ€§èƒ½æµ‹è¯•: 1000-10000
   - å‹åŠ›æµ‹è¯•: 10000+

3. **ç½‘ç»œè€ƒè™‘**:
   - æœ¬åœ°ç½‘ç»œ: å¯ä»¥è®¾ç½®è¾ƒé«˜å¹¶å‘
   - è·¨åœ°åŒºç½‘ç»œ: å»ºè®®é™ä½å¹¶å‘æ•°

## å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ `make fmt` æ ¼å¼åŒ–ä»£ç 
- ä½¿ç”¨ `make vet` æ£€æŸ¥ä»£ç 
- ä½¿ç”¨ `make lint` è¿è¡Œlinterï¼ˆéœ€è¦å…ˆå®‰è£…golangci-lintï¼‰

### æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
make test

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
make test-coverage
```

### çƒ­é‡è½½å¼€å‘

å®‰è£…airå·¥å…·åå¯ä»¥ä½¿ç”¨çƒ­é‡è½½ï¼š

```bash
make install-air
make dev
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **APIå¯†é’¥æ— æ•ˆ**: 
   - æ£€æŸ¥PostHogé¡¹ç›®è®¾ç½®ä¸­çš„APIå¯†é’¥
   - ç¡®è®¤APIå¯†é’¥æ ¼å¼æ­£ç¡®ï¼ˆä»¥`phc_`å¼€å¤´ï¼‰

2. **ç½‘ç»œè¿æ¥é—®é¢˜**: 
   - ç¡®è®¤PostHogç«¯ç‚¹URLæ­£ç¡®
   - æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®

3. **é«˜å¤±è´¥ç‡**:
   - é™ä½å¹¶å‘æ•°
   - æ£€æŸ¥ç½‘ç»œå»¶è¿Ÿ
   - ç¡®è®¤PostHogæœåŠ¡çŠ¶æ€

4. **ä¾èµ–é—®é¢˜**: 
   - è¿è¡Œ `make deps` é‡æ–°å®‰è£…ä¾èµ–
   - æ£€æŸ¥Goç‰ˆæœ¬å…¼å®¹æ€§

### æ€§èƒ½ä¼˜åŒ–

1. **æé«˜æˆåŠŸç‡**:
   - é€‚å½“é™ä½å¹¶å‘æ•°
   - å¢åŠ é‡è¯•æœºåˆ¶
   - ä½¿ç”¨æ›´ç¨³å®šçš„ç½‘ç»œç¯å¢ƒ

2. **æé«˜ååé‡**:
   - å¢åŠ å¹¶å‘æ•°ï¼ˆåœ¨å¯æ¥å—èŒƒå›´å†…ï¼‰
   - ä¼˜åŒ–ç½‘ç»œé…ç½®
   - ä½¿ç”¨æ›´è¿‘çš„PostHogç«¯ç‚¹

### è°ƒè¯•æ¨¡å¼

å¦‚éœ€å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼Œå¯ä»¥ä¿®æ”¹ä»£ç ï¼š

```go
client, _ := posthog.NewWithConfig("YOUR_API_KEY", posthog.Config{
    Endpoint: "https://us.i.posthog.com",
    Logger:   posthog.NewDefaultLogger(),
})
```

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼